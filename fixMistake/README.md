# fixMistake

Автоматическая конвертация текста между раскладками клавиатуры для Fedora Linux.

## Что это?

fixMistake - утилита, которая исправляет текст, набранный в неправильной раскладке клавиатуры. Забыли переключить раскладку и написали "ghbdtn" вместо "привет"? Просто выделите текст и нажмите Ctrl+Alt+→ - текст автоматически конвертируется!

## Особенности

- Простая двусторонняя конвертация EN ↔ RU
- Работает с выделенным текстом в любом приложении
- Автоматически определяет направление конвертации по содержимому текста
- Сохраняет оригинальное содержимое буфера обмена
- Уведомления о результате конвертации
- Горячая клавиша Ctrl+Alt+→
- Работает после перезагрузки (автозагрузка)

## Как работает?

fixMistake автоматически определяет направление конвертации:

1. **Если текст содержит кириллицу** → конвертирует в латиницу
   - `привет` → `ghbdtn`
   - `как дела` → `rfr ltkf`

2. **Если текст только латиница** → конвертирует в кириллицу
   - `ghbdtn` → `привет`
   - `rfr ltkf` → `как дела`

## Примеры работы

```
Ввод:    ghbdtn
Вывод:   привет

Ввод:    rfr ltkf?
Вывод:   как дела?

Ввод:    привет
Вывод:   ghbdtn

Ввод:    руддщ цщкдв
Вывод:   hello world
```

## Зависимости

- **xdotool** - для работы с X11 (копирование/вставка)
- **xclip** - для работы с буфером обмена
- **xbindkeys** - для глобальных горячих клавиш
- **libnotify** - для уведомлений

Все зависимости устанавливаются автоматически через `install.sh`.

## Установка

```bash
cd /path/to/FunLinux/fixMistake
./install.sh
```

Скрипт установки:
1. Проверит и установит необходимые пакеты через dnf5/dnf
2. Настроит горячую клавишу Ctrl+Alt+→ в xbindkeys
3. Добавит xbindkeys в автозагрузку
4. Перезапустит xbindkeys для применения настроек

## Использование

1. Наберите текст в неправильной раскладке
2. Выделите текст мышью или Shift+стрелки
3. Нажмите **Ctrl+Alt+→**
4. Текст автоматически исправится!

## Удаление

```bash
cd /path/to/FunLinux/fixMistake
./uninstall.sh
```

Скрипт удаления:
1. Удалит хоткей из конфигурации xbindkeys
2. Перезапустит xbindkeys
3. Удалит автозагрузку xbindkeys (если нет других хоткеев)
4. Предложит удалить зависимости (опционально)

## Файлы

- `fixmistake.sh` - основной скрипт конвертации
- `install.sh` - скрипт установки и настройки
- `uninstall.sh` - скрипт удаления
- `README.md` - документация

## Технические детали

### Алгоритм работы

1. При нажатии Ctrl+Alt+→ срабатывает xbindkeys
2. Скрипт получает выделенный текст (из PRIMARY selection или через Ctrl+C)
3. Разбивает текст на слова
4. Для каждого слова:
   - Определяет язык (латиница/кириллица)
   - Конвертирует в противоположную раскладку
5. Сохраняет текущее содержимое буфера обмена
6. Вставляет исправленный текст (Ctrl+V через xdotool)
7. Восстанавливает оригинальное содержимое буфера обмена
8. Показывает уведомление через notify-send

### Карты символов

Скрипт использует ассоциативные массивы bash для маппинга символов:
- `en_to_ru` - конвертация EN → RU (q→й, w→ц, etc.)
- `ru_to_en` - конвертация RU → EN (й→q, ц→w, etc.)

Поддерживаются:
- Все буквы в обоих регистрах
- Специальные символы ([, ], ;, ', запятая, точка, /, и т.д.)
- Буква ё/Ё

## Требования

- **ОС**: Fedora Linux (любая версия с dnf5 или dnf)
- **Окружение**: X11 (не работает на Wayland из-за ограничений безопасности)
- **DE/WM**: Любое (GNOME, KDE, i3, xfce, etc.)

## Ограничения

- Работает только в X11 (не Wayland)
- Требует выделения текста перед конвертацией
- Не конвертирует текст автоматически при вводе (только по хоткею)
- Конвертирует весь текст целиком (не умеет оставлять смешанный текст)

## Устранение проблем

### Горячая клавиша не работает

```bash
# Проверьте, запущен ли xbindkeys
ps aux | grep xbindkeys

# Перезапустите xbindkeys
killall xbindkeys
xbindkeys
```

### Проверка конфигурации

```bash
# Проверьте файл конфигурации
cat ~/.xbindkeysrc | grep -A2 fixmistake
```

### Проверка зависимостей

```bash
# Убедитесь что все утилиты установлены
command -v xdotool && echo "xdotool: OK" || echo "xdotool: НЕТ"
command -v xclip && echo "xclip: OK" || echo "xclip: НЕТ"
command -v xbindkeys && echo "xbindkeys: OK" || echo "xbindkeys: НЕТ"
command -v notify-send && echo "notify-send: OK" || echo "notify-send: НЕТ"
```

### Ручной запуск для отладки

```bash
# Запустите скрипт вручную (выделите текст перед запуском)
/path/to/fixMistake/fixmistake.sh
```

## Автор

DXVSI

## Лицензия

Free to use