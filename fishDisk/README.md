# fishDisk

Упрощенное управление дисками для Fish Shell и Fedora Linux.

## Что это?

Превращает сложные операции с дисками в простые команды:
- Вместо 10 команд вручную → 1-2 команды с fishDisk
- Интерактивный выбор через fzf
- Автоматические права доступа
- Безопасность (защита системных дисков)

## Быстрый старт

### Установка

```bash
cp disk.fish ~/.config/fish/functions/
```

### Использование

**Посмотреть диски:**
```bash
disk list
```

**Примонтировать диск:**
```bash
disk mount              # Интерактивный выбор
disk mount sda2         # Или прямо указать устройство
```

**Добавить в автозагрузку (fstab):**
```bash
disk auto sda2
```

**Форматировать новый диск (всё в одном):**
```bash
disk setup
# → Выбираешь диск
# → Выбираешь файловую систему (ext4/btrfs/xfs/ntfs/exfat)
# → Вводишь метку
# → Готово! Отформатирован, примонтирован, в fstab
```

**Размонтировать:**
```bash
disk unmount
```

**Исправить права доступа:**
```bash
disk fix
```

## Что делает автоматически?

### disk mount
- Создает точку монтирования (например `/mnt/Куцый`)
- Монтирует с правильными опциями для NTFS/FAT/ext4
- Устанавливает владельца на текущего пользователя
- Никаких паролей при работе с файлами

### disk auto
- Получает UUID диска
- Создает backup /etc/fstab
- Добавляет правильную строку в fstab
- Тестирует через `mount -a`
- Откатывает при ошибке

### disk setup
- Форматирование в выбранную ФС
- Валидация и транслитерация меток (Данные → Dannie)
- Создание раздела на пустом диске
- Автоматическое монтирование
- Добавление в fstab

## Безопасность

- Системные диски защищены от форматирования
- Автоматический backup fstab перед изменениями
- Двойное подтверждение для опасных операций (ввод DELETE)
- Проверка открытых файлов перед размонтированием

## Зависимости

**Обязательные:**
- lsblk, blkid, mount, umount, df, sudo

**Опциональные (улучшают функционал):**
- fzf - интерактивный выбор дисков
- parted - создание разделов на пустых дисках
- ntfs-3g - монтирование NTFS дисков
- fuser - быстрая проверка открытых файлов
- lsof - альтернативная проверка процессов

Все зависимости устанавливаются автоматически при первом запуске.

## Поддерживаемые файловые системы

- ext4, ext3, ext2 (рекомендуется для Linux)
- btrfs (продвинутая с snapshots)
- xfs (для больших файлов)
- ntfs (диски Windows)
- exfat (флешки, кроссплатформенная)
- vfat/fat32 (старые флешки)

## Примеры использования

### Добавить диск Windows в систему
```bash
disk mount sda2         # Монтирует NTFS с uid/gid
disk auto sda2          # Добавляет в fstab
```

### Отформатировать флешку
```bash
disk setup sdb1
# → Выбираешь exFAT
# → Вводишь метку "MyFlash"
# → Готово
```

### Размонтировать перед извлечением
```bash
disk unmount /mnt/flash
```

## Полная документация

```bash
disk --help
```

## Особенности

- Только для Fedora Linux (dnf5/dnf)
- Работает из одного файла (56KB)
- Интерактивный и командный режимы
- Цветной вывод
- Поддержка кириллицы в метках (с транслитерацией)
